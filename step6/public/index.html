<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agent Orchestration Dashboard</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="shell">
      <header class="hero panel reveal">
        <p class="eyebrow">Local QA Console</p>
        <h1>Agent Orchestration Test Dashboard</h1>
        <p class="subtitle">
          Step6 기준으로 advisory 보조 판단, review loop, PR package 생성 경로를 한 번에 검증합니다.
        </p>
      </header>

      <section class="panel panel-wide reveal quick-topic-panel" aria-labelledby="quick-topic-title">
        <div class="panel-head">
          <h2 id="quick-topic-title">Quick Topic Run</h2>
          <span class="phase-meta">상단 주제 입력만으로 즉시 오케스트레이션 실행</span>
        </div>
        <form id="quick-topic-form" class="quick-topic-form">
          <label for="quick-topic">Topic</label>
          <textarea
            id="quick-topic"
            required
            placeholder="예: NextJs16 + shadcn 설치 자동화 워크플로를 실행해줘"
          ></textarea>
          <label for="quick-workspace-root">Workspace Root</label>
          <input id="quick-workspace-root" type="text" value="" placeholder="기본값: 서버 workspace 절대경로" />
          <label class="checkbox-row" for="quick-topic-autonomous">
            <input id="quick-topic-autonomous" type="checkbox" checked />
            Autonomous (advisor enabled)
          </label>
          <button id="quick-topic-run" type="submit" class="button">Start Quick Run</button>
          <p class="field-hint quick-topic-hint">
            Quick Run은 기본 smoke file/validation command를 사용합니다. 필요 시 아래 Step6 Session Runner에서 상세 옵션을 설정하세요.
          </p>
        </form>
      </section>

      <section class="panel reveal panel-third" aria-labelledby="diag-title">
        <div class="panel-head">
          <h2 id="diag-title">Diagnostics</h2>
          <button id="refresh-overview" type="button" class="button ghost">Refresh</button>
        </div>

        <div class="diag-grid">
          <button id="ping-health" type="button" class="button">App Health</button>
          <button id="ping-llm" type="button" class="button">LLM Ping</button>
        </div>

        <label for="ping-prompt" class="field-label">LLM Prompt</label>
        <input
          id="ping-prompt"
          type="text"
          value="Respond with one short line: ping accepted"
          autocomplete="off"
        />

        <label for="tool-command" class="field-label">Test Command</label>
        <div class="command-row">
          <input id="tool-command" type="text" value="pnpm test" autocomplete="off" />
          <button id="run-command" type="button" class="button">Run</button>
        </div>

        <pre id="diagnostics-output" class="console" aria-live="polite">No diagnostics yet.</pre>
      </section>

      <section class="panel reveal panel-third" aria-labelledby="run-title">
        <h2 id="run-title">Step6 Session Runner</h2>
        <form id="session-form" class="form-grid">
          <label for="session-preset">Session presets (12)</label>
          <select id="session-preset" aria-describedby="session-preset-help">
            <option value="">시나리오를 선택하세요</option>
          </select>
          <p id="session-preset-help" class="preset-help">
            선택 시 Topic, File paths, Validation/Test command, Autonomous, 예산 설정이 자동 입력됩니다.
          </p>
          <div id="session-preset-preview" class="preset-preview" role="status" aria-live="polite">
            시나리오를 선택하면 Step6 체크포인트를 미리 보여줍니다.
          </div>

          <label for="topic">Topic</label>
          <textarea id="topic" required placeholder="예: step6 PR package with advisory"></textarea>

          <label for="workspaceRoot">Workspace Root</label>
          <input id="workspaceRoot" value="" placeholder="기본값: 서버 workspace 절대경로" />

          <label for="task">Legacy task (optional)</label>
          <input id="task" placeholder="(optional) topic과 동일값으로 처리됩니다" />

          <label for="files">File paths (comma-separated)</label>
          <input id="files" required placeholder="src/utils/json.ts,tests/json.test.ts" />

          <label for="test">Test command</label>
          <input id="test" value="pnpm test" />

          <label for="validationCommands">Validation commands (optional)</label>
          <textarea
            id="validationCommands"
            placeholder="pnpm lint&#10;pnpm typecheck&#10;pnpm test"
          ></textarea>
          <p class="field-hint">
            여러 명령은 줄바꿈으로 구분하세요. 비워두면 기본 파이프라인(`pnpm lint -> pnpm typecheck -> testCommand`)을 사용합니다.
          </p>

          <label class="checkbox-row" for="autonomous">
            <input id="autonomous" type="checkbox" checked />
            Autonomous (advisor enabled)
          </label>

          <label for="maxIterations">Max iterations</label>
          <input id="maxIterations" type="number" min="1" max="20" value="6" />

          <label for="maxMinutes">Max minutes</label>
          <input id="maxMinutes" type="number" min="1" max="180" value="45" />

          <button id="start-session" type="submit" class="button wide">Start Session</button>
        </form>
      </section>

      <section class="panel reveal panel-third" aria-labelledby="list-title">
        <div class="panel-head">
          <h2 id="list-title">Recent Sessions</h2>
          <button id="refresh-sessions" type="button" class="button ghost">Reload</button>
        </div>
        <div id="sessions-list" class="sessions-list" role="list"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="status-title">
        <h2 id="status-title">Session Status</h2>
        <pre id="status" class="console status">No session selected.</pre>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="phase-title">
        <div class="panel-head">
          <h2 id="phase-title">Phase Tracker</h2>
          <span id="phase-meta" class="phase-meta">No session selected.</span>
        </div>
        <div id="phase-tracker" class="phase-tracker" role="list"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="validation-summary-title">
        <h2 id="validation-summary-title">Step6 Validation Summary</h2>
        <div id="validation-summary" class="console validation-summary" role="status" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="review-summary-title">
        <h2 id="review-summary-title">Review Summary</h2>
        <div id="review-summary" class="console review-summary" role="status" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="pr-package-summary-title">
        <div class="panel-head">
          <h2 id="pr-package-summary-title">PR Package Summary</h2>
          <button id="refresh-pr-package" type="button" class="button ghost">Reload</button>
        </div>
        <div id="pr-package-summary" class="console review-summary" role="status" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="budget-status-title">
        <h2 id="budget-status-title">Budget Status</h2>
        <div id="budget-status" class="console budget-status" role="status" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="prompts-title">
        <h2 id="prompts-title">Agent Prompt Logs</h2>
        <div id="prompt-logs" class="console prompt-logs" role="log" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="supervisor-monitor-title">
        <div class="panel-head">
          <h2 id="supervisor-monitor-title">Supervisor Monitor</h2>
          <span id="supervisor-meta" class="phase-meta">No session selected.</span>
        </div>
        <div class="supervisor-toolbar">
          <label class="filter-chip supervisor-option">
            <input id="supervisor-include-advisor" type="checkbox" checked />
            Include advisor events
          </label>
        </div>
        <div id="supervisor-log" class="console supervisor-log" role="log" aria-live="polite"></div>
      </section>

      <section class="panel panel-wide reveal" aria-labelledby="events-title">
        <h2 id="events-title">Live Event Stream</h2>
        <div class="events-toolbar" role="group" aria-label="Event role filter">
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="supervisor" checked />
            Supervisor
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="dev" checked />
            Dev
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="test" checked />
            Test
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="planner" checked />
            Planner
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="architect" checked />
            Architect
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="designer" checked />
            Designer
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="reviewer" checked />
            Reviewer
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="advisor" checked />
            Advisor
          </label>
          <label class="filter-chip">
            <input type="checkbox" data-role-filter value="packager" checked />
            Packager
          </label>
        </div>
        <div id="events" class="console events" role="log" aria-live="polite"></div>
      </section>
    </main>

    <script src="/app.js" defer></script>
  </body>
</html>
